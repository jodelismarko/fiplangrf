<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:cfw="http://ceprofw.cepromat.mt.gov.br/components"
	xmlns:sind="http://ceprofw.cepromat.mt.gov.br/sindesa"
	template="/WEB-INF/templates/mainPopup.xhtml">

	<ui:define name="contents">
		<sind:form id="crudForm">
			<cfw:moldura
				titulo="#{manterUnidadeAdministrativaBean.modoDesc} Unidade Administrativa"
				icone="#{manterUnidadeAdministrativaBean.modoIcon}">
				<cfw:panelFloat>

					<cfw:formInputCNPJ id="numrCNPJ" labelValue="CNPJ" required="true"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.numrCNPJFormatado}"
						readonly="#{!manterUnidadeAdministrativaBean.modoInclusao}"
						containerWidth="Container33">
						<p:ajax event="blur" update="@([id$=numrCNPJ])"
							process="@([id$=numrCNPJ])" />
					</cfw:formInputCNPJ>

					<cfw:formInputText id="nomeEmpresarial"
						labelValue="Nome Empresarial" containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.nomeEmpresarial}"
						maxlength="200"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="true" />

					<cfw:formInputText id="sigla" labelValue="Sigla"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.sigla}"
						maxlength="20"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="false" />

					<cfw:formSelectOneMenu id="situacaoCnpj" labelValue="Situação CNPJ"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.situacaoCnpj}"
						itemsValue="#{combosEnumHelperBean.dominioSituacaoCadastralCnpj}"
						itemLabel="#{item.desc}" itemValue="#{item}"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="true" />

					<cfw:formSelectOneMenu id="tipoPoder" labelValue="Tipo Poder"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.tipoPoder}"
						itemsValue="#{combosEnumHelperBean.dominioTipoPoder}"
						itemLabel="#{item.desc}" itemValue="#{item}"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="true">
						<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
						<p:ajax update="@([id$=tipoAdministracao])"
							listener="#{manterUnidadeAdministrativaBean.refreshTipoPoder}" />
					</cfw:formSelectOneMenu>

					<cfw:fieldDecorator labelValue="Tipo Administração"
						idComponent="tipoAdministracao" containerWidth="Container33">
						<p:autoComplete id="tipoAdministracao" dropdown="true"
							readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao }"
							required="true" scrollHeight="250"
							completeMethod="#{manterUnidadeAdministrativaBean.autoCompleteTipoAdministracao}"
							containerWidth="Container33" var="tipoAdministracao"
							itemLabel="#{tipoAdministracao.descricao}"
							type="br.gov.mt.mti.fiplangrf.model.tabelas.TipoAdministracao"
							itemValue="#{tipoAdministracao}" converter="entityConverter"
							value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.tipoAdministracao}" />
					</cfw:fieldDecorator>

					<cfw:formSelectOneMenu id="unidadeCadastradaFiplan"
						labelValue="Unidade Orçamentária Cadastrada no FIPLAN"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.unidadeCadastraFiplan}"
						itemsValue="#{combosEnumHelperBean.dominioSimNao}"
						itemLabel="#{item.desc}" itemValue="#{item}"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="true">
						<p:ajax update="@([id$=unidadeOrcamentaria])"
							listener="#{manterUnidadeAdministrativaBean.refreshUnidadeOrcamentaria}" />
					</cfw:formSelectOneMenu>

					<cfw:fieldDecorator labelValue="Unidade Orçamentária"
						idComponent="unidadeOrcamentaria" containerWidth="Container33">
						<p:autoComplete id="unidadeOrcamentaria" dropdown="true"
							readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
							required="true" scrollHeight="250"
							completeMethod="#{manterUnidadeAdministrativaBean.autoCompleteUnidadeOrcamentaria}"
							containerWidth="Container33" var="unidadeOrcamentaria"
							itemLabel="#{unidadeOrcamentaria.descricaoFormatado}"
							type="br.gov.mt.mti.fiplangrf.model.fiplan.FIPLANUnidadeOrcamentaria"
							itemValue="#{unidadeOrcamentaria}" converter="entityConverter"
							value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.fiplanUnidadeOrcamentaria}"
							disabled="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.unidadeCadastraFiplan eq 'NAO'}">
							<p:ajax event="change" process="@this" />
							<p:ajax event="itemSelect" process="@this" />
						</p:autoComplete>
					</cfw:fieldDecorator>


					<cfw:formCalendar id="dataAbertura" labelValue="Data Abertura "
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.dataAbertura}"
						readonly="#{!manterUnidadeAdministrativaBean.modoInclusao}"
						required="true" />

					<cfw:formCalendar id="dataTermino" labelValue="Data do Término"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.dataTermino}"
						readonly="#{!manterUnidadeAdministrativaBean.modoInclusao and !manterUnidadeAdministrativaBean.modoAlteracao}"
						required="false" />

					<cfw:formSelectOneMenu id="tipoNaturezaJuridica"
						labelValue="Tipo Natureza Jurídica" containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.tipoNaturezaJuridica}"
						itemsValue="#{combosEnumHelperBean.dominioTipoNaturezaJuridica}"
						itemLabel="#{item.desc}" itemValue="#{item}"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
						required="false">
						<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
						<p:ajax update="@([id$=naturezaJuridica])"
							listener="#{manterUnidadeAdministrativaBean.refreshTipoNaturezaJuridica}"/>
					</cfw:formSelectOneMenu>

					<cfw:fieldDecorator labelValue="Natureza Jurídica"
						idComponent="naturezaJuridica" containerWidth="Container33">
						<p:autoComplete id="naturezaJuridica" forceSelection="true"
							dropdown="true"
							readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao}"
							required="true" scrollHeight="250"
							completeMethod="#{manterUnidadeAdministrativaBean.autoCompleteNaturezaJuridica}"
							containerWidth="Container33" var="naturezaJuridica"
							itemLabel="#{naturezaJuridica.descricao}"
							type="br.gov.mt.mti.fiplangrf.model.tabelas.NaturezaJuridica"
							itemValue="#{naturezaJuridica}" converter="entityConverter"
							value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.naturezaJuridica}">
							<p:ajax event="change" process="@this" />
							<p:ajax event="itemSelect" process="@this" />
						</p:autoComplete>
					</cfw:fieldDecorator>

					<cfw:formSelectOneMenu id="situacao" labelValue="Situação"
						containerWidth="Container33"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.situacao}"
						itemsValue="#{combosEnumHelperBean.dominioSituacao}"
						itemLabel="#{item.desc}" itemValue="#{item}"
						readonly="#{manterUnidadeAdministrativaBean.modoVisualizacao or manterUnidadeAdministrativaBean.modoInclusao}"
						required="false" />

					<cfw:formCalendar labelValue="Data de Cadastro"
						containerwidth="Container33" pattern="dd/MM/yyyy HH:mm:ss"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.dataCriacao}"
						rendered="#{manterUnidadeAdministrativaBean.modoAlteracao or manterUnidadeAdministrativaBean.modoExclusao or manterUnidadeAdministrativaBean.modoVisualizacao}"
						readonly="true" required="true" />

					<cfw:formCalendar labelValue="Data da Última Alteração"
						containerwidth="Container33" pattern="dd/MM/yyyy HH:mm:ss"
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.dataAtualizacao}"
						rendered="#{manterUnidadeAdministrativaBean.modoAlteracao or manterUnidadeAdministrativaBean.modoExclusao or manterUnidadeAdministrativaBean.modoVisualizacao}"
						readonly="true" />

				</cfw:panelFloat>

				<!-- 	CNAE -->
				<cfw:container containerWidth="Container100">
					<p:dataTable id="tableCnae" emptyMessage="Sem Registros."
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.cnaes}"
						var="cnae">
						<f:facet name="header">
							<h:outputText value="CNAE" style="margin-right:5px;" />
							<p:commandButton id="idAddCNAE"
								actionListener="#{manterUnidadeAdministrativaBean.addNewCnae}"
								rendered="#{!manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}"
								process="@this" update="@([id$=dlgFormCnae])" icon="fa fa-plus"
								styleClass="RaisedButton" />
						</f:facet>

						<p:column headerText="Número CNAE" width="40">
							<h:outputText value="#{cnae.numeroCNAEFormatado}" />
						</p:column>
						<p:column headerText="Descrição" width="180"
							style="white-space: normal; word-wrap: break-word;">
							<h:outputText value="#{cnae.descricaoAtividade}" />
						</p:column>
						<p:column headerText="Atividade" width="60">
							<h:outputText value="#{cnae.flagTipoAtividade.desc}" />
						</p:column>
						<p:column headerText="Situação" width="40">
							<h:outputText value="#{cnae.situacao.desc}" />
						</p:column>
						<p:column width="40" headerText="Ações">

							<p:commandButton id="visualizarCnae" immediate="true"
								actionListener="#{manterUnidadeAdministrativaBean.visualizarCnae(cnae)}"
								icon="fa fa-file-text white Fs10"
								update="@([id$='crudForm']), @([id$='dlgFormCnae'])"
								rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao or manterUnidadeAdministrativaBean.modoExclusao}" />

							<p:commandButton id="editarCnae" immediate="true"
								actionListener="#{manterUnidadeAdministrativaBean.editarCnae(cnae)}"
								rendered="#{manterUnidadeAdministrativaBean.modoAlteracao and cnae.id ne null}"
								icon="fa fa-pencil white Fs10"
								update="@([id$='crudForm']), @([id$='dlgFormCnae'])" />

							<p:commandButton icon="fa fa-trash white Fs10" id="excluirCnae"
								action="#{manterUnidadeAdministrativaBean.excluirCnae(cnae)}"
								process="@([id$=tableCnae])" update="@([id$=tableCnae])"
								rendered="#{manterUnidadeAdministrativaBean.modoInclusao or cnae.id eq null}">
								<p:confirm header="Excluir CNAE"
									message="Deseja realmente excluir esse registro?"
									icon="ui-icon-alert" />
							</p:commandButton>

							<p:button icon="fa fa-clock-o white Fs10"
								title="Visualizar Histórico"
								rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}"
								onclick="return setPathId('/cnaeunidadeadministrativa/visualizarHistorico',#{cnae.id})" />

						</p:column>

					</p:dataTable>
				</cfw:container>

				<!-- 	Legislaçao -->
				<cfw:container containerWidth="Container100">
					<p:dataTable id="tableLegislacao" emptyMessage="Sem Registros."
						value="#{manterUnidadeAdministrativaBean.unidadeAdministrativa.legislacaoUAs}"
						var="legislacao">
						<f:facet name="header">
							<h:outputText value="Legislação Unidade Administrativa"
								style="margin-right:5px;" />
							<p:commandButton id="idAddLegislacao"
								actionListener="#{manterUnidadeAdministrativaBean.addNewLegislacao}"
								rendered="#{!manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}"
								process="@this" update="@([id$=dlgFormLegislacao])"
								icon="fa fa-plus" styleClass="RaisedButton" />
						</f:facet>

						<p:column headerText="Tipo Legislação" width="30">
							<h:outputText value="#{legislacao.tipoLegislacao.desc}" />
						</p:column>

						<p:column headerText="Lei" width="190"
							style="white-space: normal; word-wrap: break-word;">
							<h:outputText value="#{legislacao.descricao}" />
						</p:column>

						<p:column headerText="Situação" width="30">
							<h:outputText value="#{legislacao.situacao.desc}" />
						</p:column>

						<p:column width="30" headerText="Ações">

							<p:commandButton id="visualizarLegislacao" immediate="true"
								actionListener="#{manterUnidadeAdministrativaBean.visualizarLegislacao(legislacao)}"
								icon="fa fa-file-text white Fs10"
								update="@([id$='crudForm']), @([id$='dlgFormLegislacao'])"
								rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao or manterUnidadeAdministrativaBean.modoExclusao}" />

							<p:commandButton id="editarLegislacao" immediate="true"
								actionListener="#{manterUnidadeAdministrativaBean.editarLegislacao(legislacao)}"
								rendered="#{manterUnidadeAdministrativaBean.modoAlteracao and legislacao.id ne null}"
								icon="fa fa-pencil white Fs10"
								update="@([id$='crudForm']), @([id$='dlgFormLegislacao'])" />

							<p:commandButton icon="fa fa-trash white Fs10"
								id="excluirLegislacao"
								action="#{manterUnidadeAdministrativaBean.excluirLegislacao(legislacao)}"
								process="@([id$=tableLegislacao])"
								update="@([id$=tableLegislacao])"
								rendered="#{manterUnidadeAdministrativaBean.modoInclusao or legislacao.id eq null}">
								<p:confirm header="Excluir Legislação"
									message="Deseja realmente excluir esse registro?"
									icon="ui-icon-alert" />
							</p:commandButton>

							<p:button icon="fa fa-clock-o white Fs10"
								title="Visualizar Histórico"
								rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}"
								onclick="return setPathId('/legislacaounidadeadministrativa/visualizarHistorico',#{legislacao.id})" />

						</p:column>

					</p:dataTable>
				</cfw:container>
			</cfw:moldura>

			<cfw:panelButtons>
				<p:outputPanel id="molduraBotoes"
					styleClass="ui-ceprofw-panel-botoes" layout="block">
					<p:commandButton id="salvar"
						actionListener="#{manterUnidadeAdministrativaBean.salvar}"
						value="Salvar" icon="fa fa-floppy-o white Fs14"
						styleClass="ResponsiveButton" process="@([id$=crudForm])"
						update="@([id$=crudForm])"
						rendered="#{!manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}" />

					<p:commandButton id="alterar"
						action="pretty:alterarUnidadeAdministrativa" value="Alterar"
						icon="fa fa-floppy-o white Fs14" styleClass="ResponsiveButton"
						process="@([id$=crudForm])" update="@([id$=crudForm])"
						rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}" />

					<p:commandButton id="excluir"
						action="#{manterUnidadeAdministrativaBean.excluir}"
						value="Excluir" icon="fa fa-check white Fs14" update="@form"
						styleClass="ResponsiveButton"
						rendered="#{manterUnidadeAdministrativaBean.modoExclusao}">
						<p:confirm header="#{helperBean.mensagemHeaderExclusao}"
							message="#{helperBean.mensagemConfirmarExclusao}"
							icon="ui-icon-alert" />
					</p:commandButton>

					<p:commandButton id="limpar"
						actionListener="#{manterUnidadeAdministrativaBean.limpar}"
						value="Limpar" process="@this" update="@([id$=crudForm])"
						resetValues="true" icon="fa fa-eraser white Fs14"
						styleClass="ResponsiveButton"
						rendered="#{manterUnidadeAdministrativaBean.id eq null and !manterUnidadeAdministrativaBean.modoExclusao}" />

					<p:button id="novaPesquisa" value="Nova Pesquisa"
						rendered="#{manterUnidadeAdministrativaBean.modoVisualizacao and !manterUnidadeAdministrativaBean.modoExclusao}"
						onclick="return parentPopupClose()"
						icon="fa fa-mail-reply white Fs14" />

					<p:commandButton id="cancelarEdicao" value="Cancelar"
						rendered="#{manterUnidadeAdministrativaBean.modoAlteracao}"
						action="pretty:visualizarUnidadeAdministrativa"
						icon="fa fa-close white Fs14" />

					<p:button id="cancelarExclusao" value="Cancelar"
						rendered="#{manterUnidadeAdministrativaBean.modoExclusao or manterUnidadeAdministrativaBean.modoInclusao}"
						onclick="return parentPopupClose()" icon="fa fa-close white Fs14" />

					<p:button id="historico"
						onclick="return setPathId('/unidadeadministrativa/visualizarHistorico',#{manterUnidadeAdministrativaBean.unidadeAdministrativa.id})"
						value="Histórico" icon="fa fa-clock-o white Fs14"
						styleClass="ResponsiveButton"
						rendered="#{!manterUnidadeAdministrativaBean.modoInclusao and !manterUnidadeAdministrativaBean.modoAlteracao and !manterUnidadeAdministrativaBean.modoExclusao}" />
				</p:outputPanel>
			</cfw:panelButtons>
			<ui:include src="/pages/common/confirmDialog.xhtml" />
		</sind:form>

		<sind:form prependId="dlgForm">
			<ui:include
				src="/pages/tabelas/unidadeAdministrativa/manterCNAEUnidadeAdministrativa.xhtml" />

			<ui:include
				src="/pages/tabelas/unidadeAdministrativa/manterLegislacaoUnidadeAdministrativa.xhtml" />
		</sind:form>
	</ui:define>
</ui:composition>
